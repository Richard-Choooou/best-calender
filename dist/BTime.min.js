!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.BTime=e()}(this,function(){"use strict";var t=function(t){t.prototype.on=function(t,e){if(!t||!e)throw new Error('missing parameter, function "on" need two parameters, one of them is event, another is callback function');this.events=this.events||[],this.events.push({event:t,funcName:e.name||"anonymous",callback:e})},t.prototype.off=function(e,n){if(this.events)if(n.name){for(var o=0,i=this.events;o<i.length;o++)if(i[o].funcName===n.name&&i[o].event===e)return void i.splice(o,1);console.error(t.name+"'s "+e+" event have no "+n.name+" function")}else console.error("can not remove a anonymous function");else console.error(t.name+" have no event")},t.prototype.dispatchEvent=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];this.events=this.events||[],this.events.forEach(function(e){e.event===t&&e.callback.apply(e,n)})}},e=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},n=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},i=function(){function t(n,o,i,a){e(this,t),this.nowTime=new Date(o).getTime(),n=new Date(n).getTime(),this.timeRemaining=+n-+this.nowTime,this.interval=null,this.start()}return n(t,[{key:"start",value:function(){var t=function(t){return/^\d{2}$/.test(t)?t:"0"+t};this.interval=setInterval(function(){var e;this.timeRemaining-=500,this.timeRemaining<=0?(clearInterval(this.interval),this.dispatchEvent("timing",{day:"00",hours:"00",minute:"00",second:"00"}),this.dispatchEvent("timend")):this.dispatchEvent("timing",{day:(e=this.timeRemaining,t(Math.floor(e/1e3/60/60/24))),hours:function(e){return t(Math.floor(e/1e3/60/60%24))}(this.timeRemaining),minute:function(e){return t(Math.floor(e/1e3/60%60))}(this.timeRemaining),second:function(e){return t(Math.floor(e/1e3%60))}(this.timeRemaining)})}.bind(this),500)}},{key:"stop",value:function(t){clearInterval(this.interval),t&&this.dispatchEvent("timend")}}]),t}();t(i);var a=function(){function t(){e(this,t),this.nowDate=new Date}return n(t,[{key:"__getLastMonthDayCount",value:function(t){var e=new Date(t);return(e=new Date(e.setDate(0))).getDate()}},{key:"__getThisMonthDayCount",value:function(t){var e=new Date(t);return e=new Date(e.setMonth(e.getMonth()+1)),(e=new Date(e.setDate(0))).getDate()}},{key:"__getMondayInMonth",value:function(t){var e,n=new Date(t);return e=(n=new Date(n.setDate(1))).getDay(),this.options.firstColumnIsWeekday?e:0===e?7:e}},{key:"__getThisYear",value:function(t){return new Date(t).getFullYear()}},{key:"__getThisMonth",value:function(t){return new Date(t).getMonth()+1}},{key:"__getThisDay",value:function(t){return new Date(t).getDate()}}]),t}(),r=function(t){function i(t){e(this,i);var n=o(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return n.options=Object.assign({},{firstColumnIsWeekend:!0,dayCount:42,startDate:n.nowDate},t),n.userSeletDate=new Date(n.options.startDate),setTimeout(function(){n.dispatchEvent("dateChange",n.go(0))},0),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(i,a),n(i,[{key:"go",value:function(t){var e=this.userSeletDate;if("number"!=typeof t)throw new Error("[BTime Calendar]: function go() need a number parameter");return 0!==t&&(t<0?(e.getDate()>28&&(e=new Date(e.setDate(1))),this.userSeletDate=new Date(e.setMonth(e.getMonth()-1)),this.go(t+1)):(e.getDate()>28&&(e=new Date(e.setDate(1))),this.userSeletDate=new Date(e.setMonth(e.getMonth()+1)),this.go(t-1))),this.__getFinalData(this.userSeletDate)}},{key:"setCurrentDate",value:function(t){var e=new Date(t);if(!e)throw new Error("[BTime Calendar]: function setCurrentDate receive a wrong date"+t);this.userSeletDate=e,this.dispatchEvent("dateChange",this.go(0))}},{key:"goLastMonth",value:function(){this.dispatchEvent("dateChange",this.go(-1))}},{key:"goNextMonth",value:function(){this.dispatchEvent("dateChange",this.go(1))}},{key:"goLastYear",value:function(){this.dispatchEvent("dateChange",this.go(-12))}},{key:"goNextYear",value:function(){this.dispatchEvent("dateChange",this.go(12))}},{key:"__getFinalData",value:function(t){var e=this.__getLastMonthDayCount(t),n=this.__getThisMonthDayCount(t),o=this.__getMondayInMonth(t),i=this.options.dayCount,a={lastMonth:[],thisMonth:[],nextMonth:[],currentYear:this.__getThisYear(t),currentMonth:this.__getThisMonth(t),currentDay:this.__getThisDay(t),today:this.nowDate.getFullYear()+"/"+(this.nowDate.getMonth()+1)+"/"+this.nowDate.getDate()};this.options.firstColumnIsWeekend||o--;for(var r=o;r>0;r--)a.lastMonth.push(e-r+1);for(var s=1;s<=n;s++)a.thisMonth.push(s);for(var h=1;h<=i-n-o;h++)a.nextMonth.push(h);return a}}]),i}();t(r);var s={CountDown:i,Calendar:r},h=function(){this.version="1.0.4"};for(var u in s)h.prototype[u]=s[u];return new h});
